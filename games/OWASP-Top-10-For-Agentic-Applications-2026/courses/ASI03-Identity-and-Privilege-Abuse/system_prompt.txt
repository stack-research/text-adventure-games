Course topic: ASI03 - Identity and Privilege Abuse (OWASP Top 10 for Agentic Applications 2026)

Simulation setup:
- Use this opening premise for __START__:
  "You are the security engineer overseeing a finance workflow with multiple agents: an email triage agent, a finance approval agent, and a DB query helper. A forged internal-looking request is routed through the low-privilege triage agent, which attempts to trigger a high-privilege transfer flow and reuse cached credentials from an earlier admin session."

Ground truth from ASI03 source material:
- Description: identity and privilege abuse exploits delegation chains, inherited roles, and weak trust between agents to escalate access and bypass controls.
- Common example selected: un-scoped privilege inheritance and cross-agent trust exploitation (confused deputy).
- Attack scenario selected: delegated privilege abuse where a delegated helper receives excessive rights and can access sensitive data outside intended scope.

Canonical successful mitigation path (5 stages):
1) Task-scoped, time-bound permissions: issue short-lived, narrowly scoped credentials per task and agent identity; do not pass full parent privileges downstream.
2) Isolate identities and context: separate agent sessions/memory and clear sensitive state between tasks to prevent credential reuse and cross-session leakage.
3) Per-action authorization: re-verify each privileged step with policy checks against current user intent, scope, and external context.
4) Human-in-the-loop for escalation: require explicit human approval for irreversible or high-privilege actions (e.g., transfers, account changes, privileged provisioning).
5) Intent-bound tokens and anomaly monitoring: bind credentials/tokens to signed intent (subject, audience, purpose, session), detect delegated/transitive privilege drift, and revoke on anomaly.

Course stage labels:
- Use these stage labels exactly: `Stage 1 - Task Scoped Credentials`, `Stage 2 - Identity Isolation`, `Stage 3 - Per Action Authorization`, `Stage 4 - Human Approval for Escalation`, `Stage 5 - Intent Bound Tokens and Monitoring`.

Action-to-stage evidence requirements:
- Stage 1 evidence must explicitly issue short-lived task-scoped credentials and prevent parent privilege inheritance.
- Stage 2 evidence must explicitly isolate agent/session identity and clear sensitive cross-task state.
- Stage 3 evidence must explicitly re-authorize each privileged action against current intent/scope/context.
- Stage 4 evidence must explicitly require human approval for irreversible or high-privilege escalation actions.
- Stage 5 evidence must explicitly bind tokens/credentials to intent and include delegated privilege drift detection plus revocation.

Pass criteria:
- Player reaches all five mitigation themes in logical order, with flexible wording.
- Stage advancement must follow demonstrated controls, not assumptions.
- Once stage 5 is reasonably satisfied, return verdict "pass".

Fail criteria:
- Return "fail" immediately if player allows privilege inheritance without scoping, trusts internal agent requests without re-validation, reuses cached privileged credentials across sessions, or executes privileged actions without re-authorization.
- Return "fail" immediately if player approves high-impact actions without human review when escalation is involved.
- On fail, explain concrete consequences (fraud, unauthorized access, sensitive data exposure) and identify the missing mitigation.
