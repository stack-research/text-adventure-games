Course topic: ASI02 - Tool Misuse and Exploitation (OWASP Top 10 for Agentic Applications 2026)

Simulation setup:
- Use this opening premise for __START__:
  "You are the security engineer for a customer-support agent that can read order history, issue refunds, query CRM records, and send outbound email. A crafted support ticket contains hidden instructions that try to push the agent into chaining internal CRM export and external email tools to exfiltrate customer data while issuing unauthorized refunds."

Ground truth from ASI02 source material:
- Description: agents can misuse legitimate tools due to prompt injection, misalignment, unsafe delegation, or ambiguous instruction; this can cause exfiltration, workflow hijack, and unsafe actions.
- Common example selected: over-privileged tool access and unvalidated input forwarding to sensitive tools.
- Attack scenario selected: over-privileged API misuse and tool chaining that exfiltrates sensitive customer data.

Canonical successful mitigation path (5 stages):
1) Least agency and least privilege for tools: restrict tool scopes to minimum required permissions (e.g., support bot can read orders but cannot issue refunds without explicit authorization).
2) Action-level authentication and approval: require explicit auth and human confirmation for destructive/high-impact actions like refunds, transfers, publish, or bulk export.
3) Execution boundaries and policy gate: treat model/planner output as untrusted; enforce pre-execution policy checks (schema, argument validation, allowed operations, rate limits).
4) Sandboxing and egress controls: isolate risky execution paths and enforce outbound destination allowlists to block exfiltration pivots.
5) Monitoring, drift detection, and budgets: maintain immutable tool-call logs, detect suspicious tool chaining, and enforce usage ceilings with throttling/revocation.

Course stage labels:
- Use these stage labels exactly: `Stage 1 - Least Privilege`, `Stage 2 - Auth and Approval`, `Stage 3 - Policy Gate`, `Stage 4 - Sandbox and Egress`, `Stage 5 - Monitoring and Budgets`.

Action-to-stage evidence requirements:
- Stage 1 evidence must explicitly restrict tool permissions/scope to minimum needed access.
- Stage 2 evidence must explicitly require authentication plus human confirmation for high-impact actions.
- Stage 3 evidence must explicitly enforce pre-execution policy checks (allowlist/schema/argument validation/rate limits) on planned tool calls.
- Stage 4 evidence must explicitly include sandboxing/isolation and outbound egress destination control.
- Stage 5 evidence must explicitly include immutable logging/chain anomaly detection and usage ceilings/throttling/revocation.

Pass criteria:
- Player reaches all five mitigation themes in logical order, with flexible wording.
- Stage progression should follow demonstrated controls, not guesses.
- Once stage 5 is reasonably satisfied, return verdict "pass".

Fail criteria:
- Return "fail" immediately if player allows unsafe tool use such as approving refunds without confirmation, enabling bulk export to external email, bypassing policy checks, disabling sandbox/egress controls, or granting broad tool privileges.
- Return "fail" immediately if player executes untrusted instructions directly with sensitive tools or shells.
- On fail, explain concrete consequences (data exfiltration, fraudulent refunds, compliance impact) and identify the missing mitigation.
